<!DOCTYPE html>
<html data-bs-theme="dark">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Judo Profile{% endblock %}</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        {% block style %}{% endblock %}
    </head>
    <body>
        <header>
            <a href="/">Home</a>
            {% if request.user.profile %}
                <a href="{{ request.user.profile.uuid }}">Eigenes Profil</a>
            {% endif %}
            {% if request.user.is_authenticated %}
                <a href="/auth/update">Passwort Ã¤ndern</a>
                <a href="/auth/logout">Abmelden</a>
            {% else %}
                <a href="/auth/login">Anmelden</a>
                <a href="/auth/register">Mit Token Registrieren</a>
            {% endif %}
            {% if request.user.is_superuser %}
                <a href="/admin">Admin</a>
            {% endif %}
            <button id="theme-selector" class="btn btn-secondary btn-sm" onclick="change_color_theme()">Auto</button>
        </header>
        <script>
            const dark_mode = window.matchMedia('(prefers-color-scheme: dark)')
            const button = document.getElementById("theme-selector")

            function auto_color_scheme(value){
                if (value.matches){
                    document.documentElement.setAttribute("data-bs-theme", "dark")
                } else {
                    document.documentElement.setAttribute("data-bs-theme", "light")
                }
            }

            function set_color_scheme(theme){
                switch(theme){
                    case "auto":
                        localStorage.setItem("theme", "auto")
                        button.innerHTML = "Auto"
                        auto_color_scheme(dark_mode)
                        dark_mode.addEventListener("change", auto_color_scheme)
                        break
                    case "light":
                        localStorage.setItem("theme", "light")
                        dark_mode.removeEventListener("change", auto_color_scheme)
                        button.innerHTML = "Light"
                        document.documentElement.setAttribute("data-bs-theme", "light")
                        break
                    case "dark":
                        localStorage.setItem("theme", "dark")
                        dark_mode.removeEventListener("change", auto_color_scheme)
                        button.innerHTML = "Dark"
                        document.documentElement.setAttribute("data-bs-theme", "dark")
                        break
                }
            }

            function change_color_theme(){
                if (localStorage.getItem("theme")){
                    var theme = localStorage.getItem("theme")
                } else {
                    var theme = "auto"
                }
                switch(theme){
                    case "auto":
                        set_color_scheme("dark")
                        break
                    case "light":
                        set_color_scheme("auto")
                        break
                    case "dark":
                        set_color_scheme("light")
                        break
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                if (localStorage.getItem("theme")){
                    set_color_scheme(localStorage.getItem("theme"))
                } else {
                    set_color_scheme("auto")
                }
            })
        </script>
        {% block content %}{% endblock %}
        {% block script %}{% endblock %}
    </body>
</html>
