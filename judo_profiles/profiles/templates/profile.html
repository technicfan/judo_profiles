{% extends "profile_base.html" %}
{% load static %}

{% block style %}
    <link rel="stylesheet" href="{% static "style/profile.css" %}">
{% endblock %}

{% block hidden_data %}
    <div id="hidden_own">
        {% for t in own_techniques %}
            <div class="own_technique" data-direction={{ t.direction }}>
                <p>{{ t.technique }}</p>
                {% if t.side %}
                    <div class="table position l">L</div>
                {% else %}
                    <div class="table position r">R</div>
                {% endif %}
                <div class="table position l no_margin">{{ t.left_position.number }}</div>
                <div class="table position r">{{ t.right_position.number }}</div>
                {{ t.state }}
            </div>
        {% endfor %}
    </div>
    <ul id="hidden_pos">
        {% for p in positions %}
            <li class="pos_data"
                data-id="p{% if p.side %}L{% else %}R{% endif %}{{ p.number }}"
                data-y={{ p.y }}
                data-x={{ p.x }}
            ></li>
        {% endfor %}
    </ul>
{% endblock %}

{% block general_info %}
    <p id="title">Kämpferprofil von</p>
    <p>{{ fighter.last_name }}, {{ fighter.name }} - Jahrgang: {{ fighter.year }}, Gewicht: {{ fighter.weight }}kg</p>
    <p>geändert: {{ fighter.updated_on }}</p>
{% endblock %}

{% block opts_left %}onclick="return false" {% if fighter.primary_side != 2 %} checked {% endif %}{% endblock %}

{% block opts_right %}onclick="return false" {% if fighter.primary_side != 1 %} checked {% endif %}{% endblock %}

{% block special %}
    {% for item in special_rank %}
        <tr class="rank_item">
            <td> <b>{{ item.number }}</b> </td>
            <td>{{ item.technique }}</td>
        </tr>
    {% endfor %}
{% endblock %}

{% block ground %}
    {% for item in ground_rank %}
        <tr class="rank_item">
            <td> <b>{{ item.number }}</b> </td>
            <td>{{ item.technique }}</td>
        </tr>
    {% endfor %}
{% endblock %}

{% block combination %}
    {% for item in combination_rank %}
        <tr class="rank_item">
            <td> <b>{{ item.number }}</b> </td>
            <td>{{ item.technique1 }} + {{ item.technique2 }}</td>
        </tr>
    {% endfor %}
{% endblock %}

{% block buttons %}
    {% load guardian_tags %}
    {% get_obj_perms request.user for fighter as "fighter_perms" %}
    {% if "change_fighter" in fighter_perms %}
        <button onclick="location.href += '/edit'">Bearbeiten</button>
    {% endif %}
    {% if "manage_fighter" in fighter_perms %}
        <button onclick="location.href += '/manage'">Verwalten</button>
    {% endif %}
{% endblock %}

{% block script %}
    <script>
        document.querySelectorAll(".pos_data").forEach(pos => {
            position = document.getElementById(pos.dataset["id"])
            position.style.display = "flex"
            colorSelected(position.className[0] + " " + position.className.slice(-1), "black")
            placeRelative(
                position,
                pos.dataset["y"],
                pos.dataset["x"]
            )
        })

        document.querySelectorAll(".own_technique").forEach(div => {
            $("#own" + div.dataset["direction"]).append(div)
        })
    </script>
{% endblock %}
